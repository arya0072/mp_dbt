{{
  config(
    materialized= 'table'
  )
}}

SELECT 
  Item,
  ItemDescription,
  SUM(CASE WHEN TransDate < TIMESTAMP '2023-12-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Jan,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-01-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Feb,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-02-29 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Mar,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-03-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Apr,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-04-30 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_May,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-05-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Jun,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-06-30 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Jul,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-07-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Agust,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-08-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Sept,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-09-30 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Okt,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-10-31 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Nov,
  SUM(CASE WHEN TransDate < TIMESTAMP '2024-11-30 00:00:00' THEN CAST(Qty AS FLOAT64) ELSE 0 END) AS Saldo_awal_Des
FROM {{ source('mp_infor', 'material_transaction_coop') }} 
GROUP BY Item, ItemDescription
